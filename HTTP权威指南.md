# HTTP权威指南

## 第一章 HTTP概述

### 媒体类型

MiME类型（MIME type），最初设计MIME（Multipurpose Internet Mail Extension，多用途因特网邮件扩展）是为了解决在不同的电子邮件系统之间搬移报文时存在的问题。MIME在电子邮件系统中工作的非常好，因此HTTP也采纳了它，用它来描述并标记多媒体内容。

- HTML格式的文本文档由text/html类型来标记。
- 普通的ASCII文本由text/plain类型来标记。
- JPEG格式的图片为image/jpeg类型。
- GIF格式的图片为image/gif类型。
- Apple的QuickTime电影为movie/quicktime类型。
- 微软的Powerpoint演示文件为application/vnd.ms-powerpoint类型。

### URI

服务器资源名被称为**统一资源标识符**（Uniform Resource Identifier，URI）。

- URL

  > 统一资源定位符（URL）是资源标识符最常见的形式。URL描述了一台特定服务器上某资源的特定位置。

- URN

  > 统一资源名（URN）。URN是作为特定内容的唯一名称使用的，与目前的资源所在地无关，还可以用同一个名字通过多种网络协议来访问资源。

### 方法

HTTP支持几种不同的请求命令，这些命令被称为HTTP方法（HTTP method）。

- GET

  从服务器向客户端发送命名资源。

- PUT

  将来自客户端的数据储存到一个命名的服务器资源中去。

- DELETE

  从服务器中删除命名资源。

- POST

  将客户端数据发送到一个服务器网关应用程序。

- HEAD

  仅发送命名资源响应中的HTTP首部。

### 报文

从Web客户端发往Web服务器的HTTP报文称为请求报文（request message）。从服务发往客户端的报文称为响应报文（response message）。

HTTP报文包括：

- 起始行

  报文的第一行就是起始行，在请求报文中用来说明要做些什么，在响应报文中说明出现了什么情况。

- 首部字段

  起始行后面有零个或多个首部。每个首部字段都包含一个名字和一个值，为了便于解析，两者之间用冒号（:）来分隔。首部以一个空行结束。添加一个首部字段或添加新行一样简单。

- 主体

  空行之后就是可选的报文主体了，其中包含了所有类型的数据。请求主体中包含了要发送给Web服务器的数据；响应主体中装载了要返回客户端的数据。起始行和首部都是文本形式并且都是结构化的，而主体则不同，主体中可以包含任意的二进制数据（比如图片、视频、音轨、软件程序）。当然，主体中也可以包含文本。

### 连接

#### TCP/IP

HTTP是个应用层协议。HTTP无需操心网络通信的具体细节；它把联网的细节都交给了通用、可靠的因特网传输协议TCP/IP。  

TCP提供：

- 无差错的数据传输。
- 按序传输（数据总是会按照发送的顺序到达）。
- 未分段的数据流（可以在任意时刻以任意尺寸将数据发送出去）。

### Web的结构组件

#### 代理

位于客户端和服务器之间的HTTP中间实体。

#### 缓存

HTTP的仓库，使常用的页面的副本可以保存在离客户端更近的地方。

#### 网关

连接其他应用程序的特殊Web服务器。

#### 隧道

对HTTP通信报文进行盲转发的特殊代理。

#### Agent代理

发起自动HTTP请求的半智能Web客户端。

## 第二章 URL和资源

### URL的语法

```
<scheme>://<user>:<password>@<host>:<port>/<path>;<params>?<query>#<frag>
```

| 组件             | 描述                                                         | 默认值       |
| ---------------- | ------------------------------------------------------------ | ------------ |
| 方案（scheme）   | 访问服务器以获取资源时要使用哪种协议                         | 无           |
| 用户（user）     | 某些方案访问资源时需要的用户名                               | anonymous    |
| 密码（password） | 用户名后面可能要包含的密码，中间由冒号（:）分隔              | <E-mail地址> |
| 主机（host）     | 资源宿主服务器的主机名或点分IP地址                           | 无           |
| 端口（port）     | 资源宿主服务器正在监听的端口号。很多方案都有默认端口号（HTTP 的默认端口号为80） | 每个方案特有 |
| 路径             | 服务器上资源的本地名，由一个斜杠（/）将其与前面的URL组件分隔开来。路径组件的语法是与服务器和方案有关的 |              |
| 参数             | 某些方案会用这个组件来指定输入参数。参数为名/值对。 URL中可以包含多个参数字段，它们相互之间以及与路径的其余部分之间用分号（;）分隔 | 无           |
| 查询             | 某些方案会用这个组件传递参数以激活应用程序（比如数 据库、 公告板、搜索引擎以及其他因特网网关）。查询组件的内容没有通用格式。 用字符“?”将其与URL的其余部分分隔开来 | 无           |
| 片段             | 一小片或一部分资源的名字。引用对象时，不会将frag字段传送给服务器；这个字段是在客户端内部使用的。通过 字符“#”将其与URL 的其余部分分隔开来 | 无           |

### 常见的方案

| 方案   | 描述                                                         |
| ------ | ------------------------------------------------------------ |
| http   | 超文本传输协议方案，除了没有用户名和密码之外，与通用的URL格式相符。如果省略了端口， 就默认为80。<br />基本格式：http://<host>:<port>/<path>?<query>#<frag><br />示例：<br />http://www.joes-hardware.com/index.html<br />http://www.joes-hardware.com:80/index.html |
| https  | 方案https与方案http是一对。唯一的区别在于方案https使用了网景的SSL，SSL为HTTP连接提供了端到端的加密机制。其语法与HTTP的语法相同，默认端口为443。<br />基本格式： https://<host>:<port>/<path>?<query>#<frag><br />示例：https://www.joes-hardware.com/secure.html |
| mailto | Mailto URL指向的是E-mail地址。由于E-mail的行为与其他方案都有所不同（它并不指向任何可以直接访问的对象），所以mailto URL的格式与标准URL的格式也有所不同。因特网 E-mail地址的语法记录在RFC 822中。<br />基本格式：mailto:<RFC-822-addr-spec><br />示例：mailto:joe@joes-hardware.com |
| ftp    | 文件传输协议URL可以用来从FTP服务器上下载或向其上载文件，并获取FTP服务器上的目录结构内容的列表。在Web和URL出现之前FTP就已经存在了。Web应用程序将FTP作为一种数据访问方案使用。URL语法遵循下列通用格式。<br />基本格式：ftp://<user>:<password>@<host>:<port>/<path>;<params><br />示例：ftp://anonymous:joe%40joes-hardware.com@prep.ai.mit.edu:21/pub/gnu/ |

## HTTP报文

