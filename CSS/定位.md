# CSS 定位

## 文档流

> MDN
>
> 定位是一个相当复杂的话题，所以我们深入了解代码之前，让我们审视一下布局理论，并让我们了解它的工作原理。
>
> 首先，围绕元素内容添加任何内边距、边界和外边距来布置单个元素盒子——这就是 [盒模型](https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/The_box_model) ，我们前面看过。默认情况下，块级元素的内容宽度是其父元素的宽度的100％，并且与其内容一样高。内联元素高宽与他们的内容高宽一样。您不能对内联元素设置宽度或高度——它们只是位于块级元素的内容中。如果要以这种方式控制内联元素的大小，则需要将其设置为类似块级元素 `display: block;`。
>
> 这只是解释了单个元素，但是元素相互之间如何交互呢？**正常的布局流**（在布局介绍文章中提到）是将元素放置在浏览器视口内的系统。默认情况下，块级元素在视口中垂直布局——每个都将显示在上一个元素下面的新行上，并且它们的外边距将分隔开它们。
>
> 内联元素表现不一样——它们不会出现在新行上；相反，它们互相之间以及任何相邻（或被包裹）的文本内容位于同一行上，只要在父块级元素的宽度内有空间可以这样做。如果没有空间，那么溢流的文本或元素将向/下移动到新行。
>
> 如果两个相邻元素都在其上设置外边距，并且两个外边距接触，则两个外边距中的较大者保留，较小的一个消失——这叫[外边距折叠](https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing),我们之前也遇到过。

## 介绍定位

> MDN
>
>  定位的整个想法是允许我们覆盖上面描述的基本文档流行为，以产生有趣的效果。如果你想稍微改变布局中一些盒子的位置，使它们的默认布局流程位置稍微有点古怪，不舒服的感觉呢？定位是你的工具。或者，如果您想要创建一个浮动在页面其他部分顶部的UI元素，并且/或者始终停留在浏览器窗口内的相同位置，无论页面滚动多少？定位使这种布局工作成为可能。 

### 静态定位（static）

静态定位是每个元素获取的默认值——它只是意味着“将元素放入它在文档布局流中的正常位置“——这里没有什么特别的。 

### 相对定位（relative）

相对定位是我们将要看的第一个位置类型。它与静态定位非常相似，占据在正常的文档流中，除了你仍然可以修改它的最终位置，包括让它与页面上的其他元素重叠。

`top`,`bottom`,`left` 和 `right` 来精确指定要将定位元素移动到的位置。 

这些属性的值可以采用逻辑上期望的任何单位——px，mm，rems，％等。 

### 绝对定位（absolute）

绝对定位的元素不再存在于正常文档布局流中。相反，它坐在它自己的层独立于一切。 

`top`，`bottom`，`left` 和 `right` 以不同的方式在绝对定位。它们指定元素应距离每个包含元素的边的距离，而不是指定元素应该移入的方向。

> 如果没有指定top，bottom，left，right，元素所在的位置为 position: static 的位置，即（原来的位置）。

当绝对定位且不设置方向值的元素在 inline box 里时:

1. 未设置的方向（top, right, bottom, left）的值是 auto。
2. 此元素 containing block 的左边缘应该是该元素前一个元素（空白符除外）的margin右边缘。
3. 此元素 containing block 的上边缘应该是该元素所在的 line box 的 content box 的上边缘。
4. 如果 left 的值为 auto, 则该元素会定位到其 containing block 的左边缘. 如果 top 的值为 auto, 则该元素会定位到其 containing block 的上边缘。

当绝对定位且不设置方向值的元素在 block box 里时:

1. 未设置的方向（top, right, bottom, left）的值是 auto。1
2. 此元素的 containing block 的左边缘应该是其父元素创建的 content box 的左边缘。
3. 如果该元素前面存在一个与其相邻的 block box, 则该元素的 containing block 的上边缘应该是这个 block box 的 margin 下边缘。
4. 如果该元素是其父元素的第一个子元素, 则该元素的 containing block 的上边缘应该是其父元素创建的content box 的上边缘.
5. 如果 left 的值为 auto, 则该元素会定位到其 containing block 的左边缘。 如果 top 的值为 auto, 则该元素会定位到其 containing block 的上边缘。

#### 定位上下文

哪个元素是绝对定位元素的“包含元素“？这取决于绝对定位元素的父元素的position属性。如果所有的父元素都没有显式地定义 position 属性，那么所有的父元素默认情况下 position 属性都是 static。结果，绝对定位元素会被包含在 **初始块容器** 中。这个初始块容器有着和浏览器视口一样的尺寸，并且 `<html>` 元素也被包含在这个容器里面。简单来说，绝对定位元素会被放在 `<html>` 元素的外面，并且根据浏览器视口来定位。

## z-index

“z-index” 是对 z 轴的参考。你可以从源代码中的上一点回想一下，我们使用水平（ x 轴）和垂直（ y 轴）坐标来讨论网页，以确定像背景图像和阴影偏移之类的东西的位置。（0, 0）位于页面（或元素）的左上角，x 和 y 轴跨页面向右和向下（适合从左到右的语言，无论如何）。网页也有一个 z 轴：一条从屏幕表面到你的脸（或者在屏幕前面你喜欢的任何其他东西）的虚线。[`z-index`](https://developer.mozilla.org/zh-CN/docs/Web/CSS/z-index) 值影响定位元素位于该轴上的位置；正值将它们移动到堆栈上方，负值将它们向下移动到堆栈中。默认情况下，定位的元素都具有 z-index 为 auto，实际上为 0。 

## 固定定位（fixed）

还有一种类型的定位覆盖 —— fixed。这与绝对定位的工作方式完全相同，只有一个主要区别：绝对定位固定元素是相对于 [`html`](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/html) 元素或其最近的定位祖先，而固定定位固定元素则是相对于浏览器视口本身。这意味着您可以创建固定的有用的 UI 项目，如持久导航菜单。

##  粘性定位（sticky）

还有一个可用的位置值称为 position:  sticky，比起其他位置值要新一些。它基本上是相对位置和固定位置的混合体，它允许被定位的元素表现得像相对定位一样，直到它滚动到某个阈值点（例如，从视口顶部起 10 像素）为止，此后它就变得固定了。例如，它可用于使导航栏随页面滚动直到特定点，然后粘贴在页面顶部。 